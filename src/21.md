# Partie 2

## DÃ©couverte du problÃ¨me

Maintenant on compte les univers oÃ¹ chaque joueur gagne. On veut le nombre
d'univers le plus grand.

Un joueur gagne quand il atteint 21.

Probablement que quand on se retrouve Ã  une position n donnÃ©e, avec un
score n donnÃ©, le passÃ© importe peu : on peut regrouper toutes les
solutions qui ammÃ¨nent Ã  ce point. Ah, mais on veut les compter ? Mmm...
- RÃ©soudre le problÃ¨me Ã  l'envers ?
- Dynamic programming ?

Peut-on le rammener au problÃ¨me de l'escalier, ou utiliser le mÃªme
principe ?

444.356.092.776.315 -> c'est  400.000 milliards. Ok. On ne va probablement pas
compter jusque-lÃ .

### DonnÃ©es

- Un dÃ© tire un chiffre de {1, 2, 3}.
- Ce dÃ© est tirÃ© trois fois pour chaque joueur
- Le joueur avance de la somme des tirages sur un tableau de 10 cases.
- Le score du joueur augmente d'un chiffre entre 1 et 10 en fonction de sa case
  d'arrivÃ©e.
- Les joueurs font trois lancers Ã  chacun leur tour.
- Le premier joueur qui Ã©gale ou dÃ©passe 21 gagne
- 1 lancer = 3 univers, un oÃ¹ le rÃ©sultat est 1, un oÃ¹ le rÃ©sultat est 2, un oÃ¹
  le rÃ©sultat est 3. Si je relance le dÃ© dans un de ces univers, il devient 3
  autres univers.


### Exploration

- On dirait qu'il faut une seconde par milliard sur ma machine, 400.000
  milliards semblent hors d'atteinte.

- Il y a 27 rÃ©sultats de lancers possibles (3^3)

- Il n'y a que 7 sommes possibles pour trois lancÃ©s : {3, 4, 5, 6, 7, 8, 9},
  soit 7 dÃ©placements possibles. Donc quand on est sur une case, on ne peut
  atteindre que 7 autres cases.

  - Les occurrences des sommes possibles sont :
    - 3 --> 1
    - 4 --> 3
    - 5 --> 6
    - 6 --> 7
    - 7 --> 6
    - 8 --> 3
    - 9 --> 1

Pour Ã©galer ou dÃ©passer le score 21, on peut finir sur n'importe quelle case de
1 Ã  10 (la case finale). Les scores prÃ©cÃ©dents peuvent Ãªtre 20, ..., 11.

Pour arriver Ã  cette case finale (et pour arriver Ã  chaque case prÃ©cÃ©dente), on
peut venir de 27 lancers mais on ne peut venir que de 7 cases (Ã  cause des 7
sommes possibles).

Dans l'autre sens, Ã  partir de la case de dÃ©part, on peut atteindre 7 cases.

### ProblÃ¨mes plus petits.

On peut rÃ©soudre le problÃ¨me pour un score Ã  dÃ©passer de 1, de deux, ...

On peut aussi rÃ©soudre le problÃ¨me pour un plateau de une case, de deux, ...

On peut aussi rÃ©soudre le problÃ¨me avec un seul dÃ©, avec deux...

On sait calculer le nombre d'univers pour un score de 1 (voir ci-dessous). On
doit arriver Ã  le faire pour un score de 2.

Si on savait calculer le max d'univers pour un score de 20, est-ce qu'on
saurait calculer le nombre d'univers pour un score de 21 ?

On peut peut-Ãªtre aussi utiliser le fait que les cases de dÃ©part sont connues
pour simplifier le pb.


#### Pour Ã©galer ou dÃ©passer 1

Quelle que soit la case de dÃ©part de j1, il va gagner. Quel que soit sa somme
de lancers, il va atteindre ou dÃ©passer 1 en premier. Il y a 27 univers
gagnants pour j1, et 0 pour j2.


#### Pour Ã©galer ou dÃ©passer 2

Si le j1 arrive sur une case autre que 1, il gagne.

Quelles sont les cases de dÃ©part qui ne peuvent pas conduire Ã  la case 1 ? Si
le joueur 1 part de la case 1, 9 ou 10, alors on se retrouve dans le cas
prÃ©cÃ©dent, il gagne Ã  tous les coups, avec 27 univers gagnants pour j1 et 0
pour j2.

Si j1 part de la case 2 :
- 26 univers conduisent Ã  une case supÃ©rieure Ã  1 et j1 gagne tout de suite.
- 1 univers conduit Ã  la case 1, et on se retrouve Ã  rÃ©soudre le mÃªme problÃ¨me
  pour le j2, qui gagne tout de suite s'il part d'une case autre que 2, et qui
  il part de la case 2 gagne tout de suite dans 26 univers et dans l'univers
  restant Ã§a revient Ã  rÃ©soudre le problÃ¨me prÃ©cÃ©dent pour le j1. Oh,
  intÃ©ressant, hello DP ?

Si j1 part de la case 3 :
- 24 univers conduisent Ã  une case supÃ©rieure Ã  1 et j1 gagne tout de suite.
- 3 univers conduisent Ã  la case 1


#### Pour Ã©galer ou dÃ©passer 3

...

Top casse-pieds si on ne connait pas la case de dÃ©part.

Fixons les cases de dÃ©part de j1 et j2 aux cases de l'exemple, 4 et 8.


#### Pour atteindre 1

On part de `(0 0) -- [1 j1 (4 1) (8 1)]`, soit 0 univers gagnants pour j1, 0
univers gagnants pour j2, et 1 univers oÃ¹ c'est Ã  j1 de jouer, j1 est en case 4
et doit atteindre le score 1, et j2 en case 8 et doit atteindre le score 1 Ã 
explorer, c'est Ã  j1 de jouer.

Partant de la case 4, tous les dÃ©placements de j1 possibles font dÃ©passer 1, 27
univers sont crÃ©Ã©s et il n'y a plus d'univers Ã  explorer.

=> `(1x27 0) --` univers.


#### Pour atteindre 2

On part de `(0 0) -- [1 j1 (4 2) (8 2)]`, soit 0 univers gagnants pour j1, 0
univers gagnants pour j2, et 1 univers oÃ¹ c'est Ã  j1 de jouer, j1 est en case 4
et doit atteindre le score 2, et j2 en case 8 et doit atteindre le score 2 Ã 
explorer, c'est Ã  j1 de jouer.

Partant de la case 4, j1 peut arriver en case 7, 8, 9, 10, 1, 2, 3.

Le seul cas oÃ¹ il n'atteint pas 2, c'est s'il arrive en case 1. Pour arriver en
case 1, il doit faire une somme de lancers de 7, ce qui correspond Ã  6 univers.
Dans les 21 autres univers, il gagne tout de suite.

=> `(1x21 0) -- [6 j2 (1 1) (8 2)]` pour l'instant, plus tous les univers qui
dÃ©coulent de la suite quand il est en case 1, avec un score de 1 (donc un score
restant Ã  dÃ©passer de 1 :fire:)

Il reste donc 6 univers Ã  traiter oÃ¹ il peut se passer ce qui suit.

Le j2 commence de la case 8, donc il peut atteindre les cases 1, 2, 3, 4, 5, 6,
7.

Si j2 n'arrive pas en case 1, ce qui est le cas dans 26 univers, j2 gagne tout
de suite, ce qui donne (1x21 6x26) -- [6x1 j1 (1 1) (1 1)], et 6 univers
restant oÃ¹ j2 arrive en case 1.

Dans ces 6 univers restants, j1 va gagner dans les 27 cas car il doit atteindre
le score 1.

On a donc au final `(1x21+6x27 6x26) --` pour atteindre 2 en partant de (4, 8).

=> (183 156).

#### Pour atteindre 3

`(0 0) -- [1 j1 (4 3) (8 3)]`

Partant de la case 4, j1 va gagner tout de suite s'il a pour dÃ©placements 3, 4,
5, 6, et 9, soit 18 univers. Il peut aussi arriver sur la case 1 dans 6
univers, et sur la case 2 dans 3 univers.

=> `(1x18 0) -- [6 j2 (1 2) (8 3)] [3 j2 (2 1) (8 3)]`

Traitons les 6 premiers univers. j2 part de la case 8, il peut atteindre les
cases 1, 2, 3, 4, 5, 6, 7. S'il atteint les cases 3+ (23 univers), il gagne
tout de suite. Les cas restant Ã  traiter sont quand j2 atteint la case 1 (un
univers), ou 2 (3 univers).

=> `(1x18 6x23) -- [6x1 j1 (1 2) (1 2)] [6x3 j1 (1 2) (2 1)] [3 j2 (2 1) (8 3)]`

On traite les 6 premiers univers Ã  nouveau. j1 doit atteindre 2 en partant de
la case 1, il y arrive forcÃ©ment dans les 27 tirages possibles.

ğŸ’¡ Tiens, cette case 1 revient souvent. Y a-t-il intÃ©rÃªt a calculer les univers
pour atteindre 1 de la case 1, 2 de la case 1 ?

=> `(1x18+6x1x27 6x23) -- [6x3 j1 (1 2) (2 1)] [3 j2 (2 1) (8 3)]`

Pareil pour les 6x3 suivants

=> `(1x18+6x1x27+6x3x27 6x23) -- [3 j2 (2 1) (8 3)]`

On remarque que quand on a j1 (1 2), j1 gagne toujours, on peut ranger
directement les cas.

On revient aux 3 cas oÃ¹ c'est Ã  j2 de jouer depuis la case 8.

ğŸ’¡ j2 (8 3) va gÃ©nÃ©rÃ©r les mÃªmes cas de victoire que prÃ©cÃ©demment. S'il atteint
les cases 3+, il gagne tout de suite.

`[3 j2 (2 1) (8 3)]` gÃ©nÃ¨re:
- 3x23 victoires de j2
- `[6x1 j1 (2 1) (1 2)] [6x3 j1 (2 1) (2 1)]` Ã  traiter.

=> `(1x18+6x1x27+6x3x27 6x23+3x23) -- [6x1 j1 (2 1) (1 2)] [6x3 j1 (2 1) (2 1)]`
=> `(1x18+6x1x27+6x3x27+6x1x27 6x23+3x23) -- [6x3 j1 (2 1) (2 1)]`
=> `(1x18+6x1x27+6x3x27+6x1x27+6x3x27 6x23+3x23) --`
=> `(1314 207)`

ğŸ’¡ Est-ce que Ã§a ressemble Ã  un algorithme qu'on pourrait implÃ©menter ?

#### Tentative d'algorithme

Ok, j'ai implÃ©mentÃ© un truc qui tourne vite mÃªme pour atteindre 21 sans
mÃ©moisation. Je n'ai pas les mÃªmes rÃ©sultas pour l'exemple donnÃ© (4 et 8), donc
quelque-chose cloche.

Pour atteindre 1 et pour atteindre 2, j'ai les mÃªmes rÃ©sultats avec mon code
que ci-dessus, c'est dÃ©jÃ  Ã§a.

Pour atteindre 3 le code n'a pas le mÃªme rÃ©sultat et c'est difficile Ã  dÃ©boguer
car mes cas ne sont pas gÃ©nÃ©rÃ©s dans le mÃªme ordre.

Refaisons le cas 3 dans le mÃªme ordre que la machine pour trouver la diffÃ©rence
(les Ã©tats Ã  traiter sont popÃ©s de la fin, les Ã©tats gÃ©nÃ©rÃ©s sont ajoutÃ©s Ã  la
fin).


`(0 0) -- [1 j1 (4 3) (8 3)]`
`(18 0) -- [6 j2 (1 2) (8 3)] [3 j2 (2 1) (8 3)]`
`(18 69) -- [6 j2 (1 2) (8 3)] [3 j1 (2 1) (1 2)] [3 j1 (2 1) (2 1)]`

Ah ! J'avais inversÃ© score et position pour le j1 dans les Ã©tats gÃ©nÃ©rÃ©s !

Pouf, Ã§a fait passer l'exemple ğŸ‰. Mais pas l'Ã©toile ğŸ˜¢ Mmm, qu'est-ce qui
coince encore ? Verdict : j'ai mis une dizaine de minutes Ã  le voir, mais il y
avait une virgule qui trainait dans mon copier-coller ğŸ¤¦


### Inconnues pas explorÃ©es

- Â· Et si la plus haute marche de l'escalier c'Ã©tait la case de dÃ©part ?
- Â· Est-ce qu'on peut partir du joueur gagnant sans savoir si c'est j1 ou j2 ?
  Et remonter jusqu'Ã  une case de dÃ©part, si c'est la case de dÃ©part de j1 ou
  j2 on garde et peut importe qui est qui puisqu'on cherche le max. Si c'est
  une autre case de dÃ©part on jette.
- Â· Comment est-ce que je rÃ©soudrais un problÃ¨me plus simple ? Score plus petit
  ? Que deux lancers de dÃ©s ? Un seul ?
- Â· Comment interagissent les joueurs entre eux dans cette affaire de
  combinatoire ?
- Â· Quelles sont les cases d'arrivÃ©es possibles pour trois lancÃ©s ?

### ExplorÃ©es

- x Combien de temps il faut pour simplement compter jusqu'Ã  400.000 milliards
  ? Voir plus haut.
- x Quelles sont les sommes possibles pour trois lancÃ©s ? Voir plus haut.


### Ã‰cartÃ©es

- x Supposons qu'on peut dÃ©terminer le nombres d'univers qui conduisent Ã  21
  pour une case de dÃ©part donnÃ©e, ce n'est pas suffisant, il faut encore que
  ces univers conduisent Ã  21 avant l'autre joueur. Il faut suivre deux scores
  pour chaque embranchement ? Alterner ? Question mal formulÃ©e, il ne faut pas
  arriver Ã  21, mais dÃ©passer 21 en premier.

- x Combien de sommes de nombres de 1 Ã  10 partant de la case de dÃ©part
  conduisent Ã  21 ? Pas relevant, car il ne faut pas arriver Ã  21, mais 21 ou
  plus.

Si case de dÃ©part est 4,
21 = 4 + ???

21 = 4 + 10 + 7
21 = 4 + (4+6) + (0+3)

21 = 4 + 7 + 10
21 = 4 + (4+3) + (7+3)

21 = 4 + 8 + 1 + 4 + 1 + 4 + 1 + 4
21 = 4 + (4+4) + (8+3) + (1+3) + (4+7) + (1+3) + (4+7) + (1+3)

Pff.

Tour 1 :

- Case j1 0 + 3 --> 1 univers
- Case j1 0 + 4 --> 3 univers
- Case j1 0 + 5 --> 6 univers
- Case j1 0 + 6 --> 7 univers
- Case j1 0 + 7 --> 6 univers
- Case j1 0 + 8 --> 3 univers
- Case j1 0 + 9 --> 1 univers

Tour 2 :

- Case j2 0 + 3 --> 1x27 univers
- Case j2 0 + 4 --> 3x27 univers
- Case j2 0 + 5 --> 6x27 univers
- Case j2 0 + 6 --> 7x27 univers
- Case j2 0 + 7 --> 6x27 univers
- Case j2 0 + 8 --> 3x27 univers
- Case j2 0 + 9 --> 1x27 univers

Tour 3 :

- Case j1 3 + 3 --> 1x27^2 univers
- Case j1 3 + 4 --> 3x27^2 univers
- Case j1 3 + 5 --> 6x27^2 univers
- Case j1 3 + 6 --> 7x27^2 univers
- Case j1 3 + 7 --> 6x27^2 univers
- Case j1 3 + 8 --> 3x27^2 univers
- Case j1 3 + 9 --> 1x27^2 univers

Tour 3' :

- Case j1 4 + 3 --> 1x27^2 univers
- Case j1 4 + 4 --> 3x27^2 univers
- Case j1 4 + 5 --> 6x27^2 univers
- Case j1 4 + 6 --> 7x27^2 univers
- Case j1 4 + 7 --> 6x27^2 univers
- Case j1 4 + 8 --> 3x27^2 univers
- Case j1 4 + 9 --> 1x27^2 univers
